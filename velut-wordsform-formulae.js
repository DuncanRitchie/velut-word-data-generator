const wordsformFormulae = {
	Ord:
		'=ROWS(words)+ROW()-1',
	Word:
		'#N/A',
	Lemmata:
		'#N/A',
	Length:
		'=LEN([@Word])',
	AllConsonants:
		'=IF(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@NoMacra(LOWER([@Word])),"a",""),"e",""),"i",""),"o",""),"u",""),"y","")="","-",SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@NoMacra(LOWER([@Word])),"a",""),"e",""),"i",""),"o",""),"u",""),"y",""))',
	Uncompounded:
		'=IFS(OR([@Word]="-ne",[@Word]="-que",[@Word]="-ve"),"∅",RIGHT([@Lemma1],3)="que",[@Word],AND(RIGHT([@Word],2)<>"ne",RIGHT([@Word],2)<>"ve",RIGHT([@Word],3)<>"que"),[@Word],OR(SUM(--EXACT(LEFT([@Word],[@Length]-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),2,RIGHT([@Word],3)="que",3)),words[Word]))>0,SUM(--EXACT(LEFT([@Word],[@Length]-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),2,RIGHT([@Word],3)="que",3)),[Word]))>0),LEFT([@Word],LEN([@Word])-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),2,RIGHT([@Word],3)="que",3)),SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(LEFT([@Word],LEN([@Word])-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),3,RIGHT([@Word],3)="que",4)),"á","a"),"é","e"),"í","i"),"ó","o"),"ú","u"),"ý","y")<>LEFT([@Word],LEN([@Word])-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),3,RIGHT([@Word],3)="que",4)),SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Word],"á","a"),"é","e"),"í","i"),"ó","o"),"ú","u"),"ý","y"),"ü","u"),SUM(--EXACT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(LEFT([@Word],LEN([@Word])-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),2,RIGHT([@Word],3)="que",3)),"á","a"),"é","e"),"í","i"),"ó","o"),"ú","u"),"ý","y"),"ü","u"),"ḗ","ē"),words[Word]))>0,SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(LEFT([@Word],LEN([@Word])-IFS(OR(RIGHT([@Word],2)="ne",RIGHT([@Word],2)="ve"),2,RIGHT([@Word],3)="que",3)),"á","a"),"é","e"),"í","i"),"ó","o"),"ú","u"),"ý","y"),"ü","u"),"ḗ","ē"),1=1,[@Word])',
	Phonetic:
		'=IF([@Word]="","_",CONCAT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(CONCAT("_",LOWER(@itojj(IFS([@Uncompounded]="ai","à",[@Uncompounded]="ei","è",[@Uncompounded]="eia","èa",[@Uncompounded]="hei","hè",[@Uncompounded]="heia","hèa",[@Uncompounded]="hoc","hocc",[@Uncompounded]="oi","ò",[@Uncompounded]="oiei","òè",[@Uncompounded]="dehinc","dènc",OR([@Uncompounded]="dein",[@Uncompounded]="deinde",[@Uncompounded]="proin",[@Uncompounded]="proindē"),SUBSTITUTE(SUBSTITUTE([@Uncompounded],"dein","dèn"),"proin","pròn"),[@Lemma1]="praeeō",SUBSTITUTE([@Word],"praei","prài"),OR(LEFT([@Lemma1],3)="cui",LEFT([@Lemma1],4)="quis",LEFT([@Lemma1],3)="quī",[@Lemma1]="aliquis",[@Lemma1]="ecquis",[@Lemma1]="nesciōquis",[@Lemma1]="ūnusquisque"),SUBSTITUTE(SUBSTITUTE(@itojj([@Uncompounded]),"cuiā","cùjā"),"cui","cù"),OR(ISNUMBER(SEARCH("ngua",[@NoMacra])),ISNUMBER(SEARCH("ngue",[@NoMacra])),ISNUMBER(SEARCH("ngui",[@NoMacra])),ISNUMBER(SEARCH("nguo",[@NoMacra])),ISNUMBER(SEARCH("nguu",[@NoMacra]))),SUBSTITUTE([@Uncompounded],"ngu","ngv",1),OR(ISNUMBER(SEARCH("suād",[@Lemma1])),ISNUMBER(SEARCH("suās",[@Lemma1])),ISNUMBER(SEARCH("suāv",[@Lemma1]))),SUBSTITUTE([@Uncompounded],"suā","svā",1),LEFT([@Word],6)="Eduard",SUBSTITUTE([@Uncompounded],"Eduard","Edvard"),ISNUMBER(SEARCH("suē",LOWER([@Lemma1]))),SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Uncompounded],"suē","svē",1),"Suē","Svē",1),"sue","sve",1),"sui","svi",1),"suī","svī",1),"suu","svu",1),[@Lemma1]="urgueō",SUBSTITUTE([@Uncompounded],"urgu","urgv"),OR(RIGHT([@Lemma1],5)="iaceō",RIGHT([@Lemma1],5)="iectō",RIGHT([@Lemma1],5)="iaciō",RIGHT([@Lemma1],6)="iectus",RIGHT([@Lemma1],5)="iectē",[@Lemma1]="abiciō",[@Lemma1]="adiciō",[@Lemma1]="circumiciō",[@Lemma1]="coniciō",[@Lemma1]="dēiciō",[@Lemma1]="disiciō",[@Lemma1]="ēiciō",[@Lemma1]="iniciō",[@Lemma1]="intericiō",[@Lemma1]="obiciō",[@Lemma1]="periciō",[@Lemma1]="praeiciō",[@Lemma1]="reiciō",[@Lemma1]="subiciō",[@Lemma1]="trāiciō",[@Lemma1]="obex",[@Lemma1]="subicēs"),SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Uncompounded],"iēc","jēc",1),"iec","jec",1),"iac","jac",1),"bex","bjex"),"ic","jic"),"rej","rèj"),LEFT([@Uncompounded],5)="coniū",REPLACE([@Uncompounded],1,5,"conjū"),LEFT([@Uncompounded],5)="coniu",REPLACE(LOWER([@Uncompounded]),1,5,"conju"),LEFT([@Uncompounded],5)="disiu",REPLACE(LOWER([@Uncompounded]),1,5,"disju"),LEFT([@Uncompounded],5)="disiū",REPLACE(LOWER([@Uncompounded]),1,5,"disjū"),OR([@Lemma1]="iniugis",[@Lemma1]="biiugis",[@Lemma1]="biiugus",[@Lemma1]="subiugō"),SUBSTITUTE([@Uncompounded],"iug","jug"),OR(LEFT([@Uncompounded],4)="adiu",LEFT([@Uncompounded],4)="adiū"),REPLACE([@Uncompounded],1,3,"adj"),LEFT([@Uncompounded],5)="iniūr",REPLACE([@Uncompounded],1,5,"injūr"),[@Lemma1]="iūsiūrandum",SUBSTITUTE([@Uncompounded],"iū","jū"),[@Lemma1]="periūrus",REPLACE([@Uncompounded],4,1,"j"),AND(OR(LEFT(LOWER([@NoMacra]),2)="ia",LEFT(LOWER([@NoMacra]),2)="ie",LEFT(LOWER([@NoMacra]),2)="ii",LEFT(LOWER([@NoMacra]),2)="io",LEFT(LOWER([@NoMacra]),2)="iu",LEFT(LOWER([@NoMacra]),2)="iy"),NOT(EXACT(UPPER(LEFT([@Word],1)),"Ī")),COUNTIF(PhoneticExceptions[Vocalic initial i],[@Lemma1])=0,[@Uncompounded]<>"iīs"),REPLACE([@Uncompounded],1,1,"j"),OR([@Lemma1]="magnus",[@Lemma1]="magis",[@Lemma1]="maiestās",[@Lemma1]="maiōrēs",[@Lemma1]="malus",[@Lemma1]="male",AND(@NoMacra([@Lemma1])="aio",OR(RIGHT(LEFT([@NoMacra],3),1)="a",RIGHT(LEFT([@NoMacra],3),1)="e",RIGHT(LEFT([@NoMacra],3),1)="i",RIGHT(LEFT([@NoMacra],3),1)="o",RIGHT(LEFT([@NoMacra],3),1)="u",RIGHT(LEFT([@NoMacra],3),1)="y"))),SUBSTITUTE([@Uncompounded],"ai","ajj"),LEFT([@Word],1)="-","",1=1,[@Uncompounded]))),"_"),"am_","ã"),"em_","ẽ"),"im_","ĩ"),"om_","õ"),"um_","ũ"),"ym_","ỹ"),"qu","q"),"ds","ts"),"z","ds"),"x","cs"),"bs","ps"),"bt","pt"),"ch","χ"),"ph","φ"),"rh","r"),"th","θ"),"ae","à"),"au","â"),"oe","ò"),"ë","e"),"ï","i"),"ü","u"),"ṻ","ū"),"á","a"),"é","e"),"í","i"),"ó","o"),"ú","u"),"ý","y"),"ḗ","ē"),"āns","ãs"),"ēns","ẽs"),"īns","ĩs"),"ōns","õs"),"ūns","ũs"),"ȳns","ỹs"),"ānf","ãf"),"ēnf","ẽf"),"īnf","ĩf"),"ōnf","õf"),"ūnf","ũf"),"ȳnf","ỹf"),"lectiient","lectijent"),"ōsuestr","ōsvestr"),"reiciav","rejcjav"),"k","c"),"eu",IF(COUNTIF(PhoneticExceptions[Diphthong eu],[@Lemma1])>0,"€","eu")),"_eu","_€"),"_€nd","eund"),"_€nt","eunt"),"eu_","€"),"_",""),IF(LEN([@Word])=LEN([@Uncompounded]),"",RIGHT(SUBSTITUTE([@Word],"qu","q"),2))))',
	Scansion:
		'=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Phonetic],"e","a"),"i","a"),"o","a"),"u","a"),"y","a"),"ē","ā"),"ī","ā"),"ō","ā"),"ū","ā"),"ȳ","ā"),"ã","ā"),"ẽ","ā"),"ĩ","ā"),"õ","ā"),"ũ","ā"),"ỹ","ā"),"à","ā"),"â","ā"),"€","ā"),"è","ā"),"ò","ā"),"ù","ā"),"ḗ","á"),"bl","br"),"cl","br"),"cr","br"),"dr","br"),"fr","br"),"fl","br"),"gl","br"),"gr","br"),"pr","br"),"pl","br"),"tr","br"),"θl","br"),"θr","br"),"φl","br"),"φr","br"),"χl","br"),"χr","br"),"br","b"),"c","b"),"d","b"),"f","b"),"g","b"),"h",""),"j","b"),"k","b"),"l","b"),"m","b"),"n","b"),"p","b"),"q","b"),"r","b"),"s","b"),"t","b"),"v","b"),"z","bb"),"φ","b"),"χ","b"),"θ","b"),"abb","ā"),"b",""),"a","⏑"),"ā","–")&(IF([@AllConsonants]=[@Word],"∅",""))',
	AllVowels:
		'=IF(OR([@Scansion]="∅",LEFT([@Word],1)="-"),"∅","")&SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Phonetic],"b","."),"c","."),"d","."),"f","."),"g","."),"h","."),"j","."),"k","."),"l","."),"m","."),"n","."),"p","."),"q","."),"r","."),"s","."),"t","."),"v","."),"x","."),"z","."),"χ","."),"φ","."),"θ","."),".","")',
	SyllableCount:
		'=LEN(SUBSTITUTE([@AllVowels],"∅",""))',
	Stress:
		'=@IFERROR(IFS([@SyllableCount]=0,0,LEFT([@Word],1)="-",2,OR([@Word]="abhinc",EXACT([@Word],"adhūc"),EXACT([@Word],"Antiās"),EXACT([@Word],"Arpīnās"),EXACT([@Word],"Asprēnās"),[@Word]="Fīdēnās",[@Word]="illāc",[@Word]="illīc",[@Word]="illinc",[@Word]="illūc",[@Word]="istīc",[@Word]="Maecēnās",[@Word]="nostrās",[@Phonetic]="posθāc",[@Word]="Samnīs",[@Word]="satin",[@Word]="Suffēnās",[@Word]="tantōn",[@Word]="viden",[@Word]="vidēn",RIGHT([@Phonetic],3)="dīc",RIGHT([@Phonetic],3)="dūc",RIGHT([@Phonetic],3)="fac",[@SyllableCount]=1),1,[@SyllableCount]=2,2,OR([@Word]="deïnde",[@Word]="exindē",[@Word]="perinde",[@Word]="proïndē",[@Word]="subinde"),3,LEFT(RIGHT([@Scansion],2),1)="–",2,LEN([@Word])<>LEN([@Uncompounded]),2,OR([@Word]="agedum",[@Word]="egomet",[@Word]="ibidem",[@Word]="meamet",[@Phonetic]="satine",[@Word]="suamet",[@Word]="ubinam"),2,SUM(IFERROR(FIND("á",[@Uncompounded]),0),IFERROR(FIND("é",[@Uncompounded]),0),IFERROR(FIND("í",[@Uncompounded]),0),IFERROR(FIND("ó",[@Uncompounded]),0),IFERROR(FIND("ú",[@Uncompounded]),0),IFERROR(FIND("ý",[@Uncompounded]),0),)>0,2,AND(OR(RIGHT([@Lemma1],3)="ius",RIGHT([@Lemma1],3)="ïus",RIGHT([@Lemma1],3)="ium",RIGHT([@Lemma1],8)="ius[prn]",RIGHT([@Lemma1],8)="ius[adj]",RIGHT([@Lemma1],6)="ius[n]",RIGHT([@Lemma1],8)="ium[prn]",RIGHT([@Lemma1],6)="ium[n]"),@reversestr(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Word],"á","a"),"é","e"),"í","i"),"ó","o"),"ú","u"),"ý","y"))=REPLACE(@reversestr(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@Lemma1],"[n]",""),"[prn]",""),"[adj]","")),1,3,"ī")),2,1=1,3),"")',
	UltimaRhyme:
		'=IF([@SyllableCount]=0,[@Phonetic],RIGHT([@Phonetic],FIND(RIGHT([@AllVowels],1),@reversestr([@Phonetic]))))',
	RhymeVowels:
		'=RIGHT([@AllVowels],[@Stress])&IF([@Scansion]="∅","∅","")',
	PerfectRhyme:
		'=IFS(LEFT([@Word],1)="-",[@Phonetic],[@Stress]=0,[@Phonetic],[@Stress]=1,[@UltimaRhyme],[@Stress]=2,reversestr(SUBSTITUTE(LEFT(SUBSTITUTE(@reversestr([@Phonetic]),RIGHT([@RhymeVowels],1),"*",1),FIND(LEFT([@RhymeVowels],1),SUBSTITUTE(@reversestr([@Phonetic]),RIGHT([@RhymeVowels],1),"*",1))),"*",RIGHT([@RhymeVowels],1))),[@Stress]=3,reversestr(LEFT(@reversestr([@Phonetic]),FIND(LEFT([@RhymeVowels],1),SUBSTITUTE(SUBSTITUTE(@reversestr([@Phonetic]),RIGHT([@RhymeVowels],1),"*",1),LEFT(RIGHT([@RhymeVowels],2),1),"*",1)))),1=1,"stressbeforeantepenult")',
	RhymeConsonants:
		'=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(CONCAT(NoMacra([@PerfectRhyme]),"."),"€","a"),"à","a"),"â","a"),"e","a"),"i","a"),"o","a"),"ó","a"),"ò","a"),"u","a"),"ù","a"),"y","a"),"ãs","ans"),"ẽs","ans"),"ĩs","ans"),"õs","ans"),"ũs","ans"),"ỹs","ans"),"ã","am"),"ẽ","am"),"ĩ","am"),"õ","am"),"ũ","am"),"ỹ","am"),".","")',
	Ultima:
		'=IFERROR(CONCAT(IF([@Stress]=2,"2 ",""),[@UltimaRhyme]),"")',
	RhymeVowelsAndUltimaCoda:
		'=IF([@Stress]=0,[@UltimaRhyme],REPLACE(RIGHT([@AllVowels],[@Stress]),LEN(RIGHT([@AllVowels],[@Stress])),1,[@UltimaRhyme]))',
	EcclesPhonetic:
		'=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(CONCAT(SUBSTITUTE(NoMacra([@Phonetic]),"ihi","iki"),"."),"òè","ojej"),"à","e"),"èn","ein"),"è","ej"),"ò","e"),"ù","uj"),"y","i"),"ã.","am"),"ẽ.","em"),"ĩ.","im"),"õ.","om"),"ũ.","um"),"ỹ.","ym"),"ã","an"),"ẽ","en"),"ĩ","in"),"õ","on"),"ũ","un"),"ỹ","yn"),"χ","c"),"φ","f"),"θ","t"),"h",""),".","")',
	EcclesVowels:
		'=IF(LEFT([@Word],1)="-","∅","")&SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE([@EcclesPhonetic],"b","."),"c","."),"d","."),"f","."),"g","."),"h","."),"j","."),"k","."),"l","."),"m","."),"n","."),"p","."),"q","."),"r","."),"s","."),"t","."),"v","."),"x","."),"z","."),".","")',
	EcclesRhymeVowels:
		'=IF([@Word]="dehinc","ei",RIGHT([@EcclesVowels],[@Stress])&IF([@Scansion]="∅","∅",""))',
	EcclesRhymeVowelsAndUltimaCoda:
		'=IF([@Scansion]="∅","∅",[@EcclesRhymeVowels]&RIGHT([@EcclesPhonetic],FIND(RIGHT([@EcclesRhymeVowels],1),@reversestr([@EcclesPhonetic]))-1))',
	EcclesPerfectRhyme:
		'=@IFS([@Word]="dehinc","einc",LEFT([@Word],1)="-",[@EcclesPhonetic],[@Stress]=0,[@EcclesPhonetic],[@Stress]=1,RIGHT([@EcclesPhonetic],FIND(RIGHT([@EcclesRhymeVowels],1),@reversestr([@EcclesPhonetic]))),[@Stress]=2,reversestr(SUBSTITUTE(LEFT(SUBSTITUTE(@reversestr([@EcclesPhonetic]),RIGHT([@EcclesRhymeVowels],1),"*",1),FIND(LEFT([@EcclesRhymeVowels],1),SUBSTITUTE(@reversestr([@EcclesPhonetic]),RIGHT([@EcclesRhymeVowels],1),"*",1))),"*",RIGHT([@EcclesRhymeVowels],1))),[@Stress]=3,reversestr(LEFT(@reversestr([@EcclesPhonetic]),FIND(LEFT([@EcclesRhymeVowels],1),SUBSTITUTE(SUBSTITUTE(@reversestr([@EcclesPhonetic]),RIGHT([@EcclesRhymeVowels],1),"*",1),LEFT(RIGHT([@EcclesRhymeVowels],2),1),"*",1)))),1=1,"stressbeforeantepenult")',
	EcclesSort:
		'=CONCAT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(CONCAT([@EcclesRhymeVowels],"-",SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@NoMacra([@EcclesPerfectRhyme]),"a","a"),"e","a"),"i","a"),"o","a"),"u","a"),"y","a"),"à","a"),"â","a"),"è","a"),"€","a"),"ò","a"),"ù","a"),"ã","a"),"ẽ","a"),"ĩ","a"),"õ","a"),"ũ","a"),"ỹ","a"),"-",IFERROR(@reversestr(LEFT([@EcclesVowels],LEN([@EcclesVowels])-LEN([@EcclesRhymeVowels]))),""),"-",SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@reversestr(LEFT([@EcclesPhonetic],LEN([@EcclesPhonetic])-LEN([@EcclesPerfectRhyme]))),"a","a"),"e","a"),"i","a"),"o","a"),"u","a"),"y","a"),"à","a"),"â","a"),"è","a"),"€","a"),"ò","a"),"ù","a"),"ã","a"),"ẽ","a"),"ĩ","a"),"õ","a"),"ũ","a"),"ỹ","a"),"-",LOWER([@Word])),"ā","azzzz"),"ē","ezzzz"),"ḗ","ezzzz"),"ī","izzzz"),"ō","ozzzz"),"ū","uzzzz"),"ȳ","yzzzz"),"ã","azzzzzz"),"ẽ","ezzzzzz"),"ĩ","izzzzzz"),"õ","ozzzzzz"),"ũ","uzzzzzz"),"ỹ","yzzzzzz"),"à","azzzzzzzz"),"â","azzzzzzzzzzzz"),"è","ezzzzzzzz"),"€","ezzzzzzzzzzzz"),"ò","ozzzzzzzz"),"ù","uzzzzzzzz"),IFERROR(IF(EXACT(LEFT([@Word],1),LOWER(LEFT([@Word],1))),IF(EXACT([@Word],LOWER([@Word])),"/",""),""),"emptystring"))',
	LemmaCount:
		'=IF([@Lemmata]="",0,IFERROR(FIND(" ",[@Lemmata],FIND(" ",[@Lemmata],FIND(" ",[@Lemmata],FIND(" ",[@Lemmata],FIND(" ",[@Lemmata])+1)+1)+1)+1)*0+6,IFERROR(FIND(" ",[@Lemmata],FIND(" ",[@Lemmata],FIND(" ",[@Lemmata],FIND(" ",[@Lemmata])+1)+1)+1)*0+5,IFERROR(FIND(" ",[@Lemmata],FIND(" ",[@Lemmata],FIND(" ",[@Lemmata])+1)+1)*0+4,IFERROR(FIND(" ",[@Lemmata],FIND(" ",[@Lemmata])+1)*0+3,IFERROR(FIND(" ",[@Lemmata])*0+2,1))))))',
	Lemma1:
		'=IFERROR(IF([@LemmaCount]=0,"",LEFT([@Lemmata],FIND(" ",[@Lemmata])-1)),[@Lemmata])',
	Lemma2:
		'=SUBSTITUTE(IF([@LemmaCount]>1,IF([@LemmaCount]=2,RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1])-1),LEFT(RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1])-1),FIND(" ",RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1])-2)))),"")," ",".")',
	Lemma3:
		'=SUBSTITUTE(IF([@LemmaCount]>2,IF([@LemmaCount]=3,RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2])-2),LEFT(RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2])-2),FIND(" ",RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2])-2))-1)),"")," ",".")',
	Lemma4:
		'=SUBSTITUTE(IF([@LemmaCount]>3,IF([@LemmaCount]=4,RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2]&[@Lemma3])-3),LEFT(RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2]&[@Lemma3])-3),FIND(" ",RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2]&[@Lemma3])-3))-1)),"")," ",".")',
	Lemma5:
		'=SUBSTITUTE(IF([@LemmaCount]>4,IF([@LemmaCount]=5,RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2]&[@Lemma3]&[@Lemma4])-4),LEFT(RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2]&[@Lemma3]&[@Lemma4])-4),FIND(" ",RIGHT([@Lemmata],LEN([@Lemmata])-LEN([@Lemma1]&[@Lemma2]&[@Lemma3]&[@Lemma4])-4))-1)),"")," ",".")',
	ScansionWithElision:
		'=IF(OR([@UltimaRhyme]="a",[@UltimaRhyme]="e",[@UltimaRhyme]="i",[@UltimaRhyme]="o",[@UltimaRhyme]="u",[@UltimaRhyme]="y",[@UltimaRhyme]="ā",[@UltimaRhyme]="ē",[@UltimaRhyme]="ī",[@UltimaRhyme]="ō",[@UltimaRhyme]="ū",[@UltimaRhyme]="ӯ",[@UltimaRhyme]="ã",[@UltimaRhyme]="ẽ",[@UltimaRhyme]="ĩ",[@UltimaRhyme]="õ",[@UltimaRhyme]="ũ",[@UltimaRhyme]="ỹ",[@UltimaRhyme]="à",[@UltimaRhyme]="â",[@UltimaRhyme]="é",[@UltimaRhyme]="€",[@UltimaRhyme]="ò",[@UltimaRhyme]="ù"),IF([@SyllableCount]=1,"∅",LEFT([@Scansion],[@SyllableCount]-1)),[@Scansion])',
	IsFitForDactyl:
		'=IF(AND(RIGHT([@Phonetic],1)=RIGHT([@AllConsonants],1),RIGHT([@Scansion],1)="–"),IFERROR(IFERROR(FIND("–⏑–",@reversestr([@Scansion]),1),FIND("⏑⏑⏑",@reversestr([@Scansion]),1))*0,1),IFERROR(IFERROR(FIND("–⏑–",@reversestr([@Scansion]),2),FIND("⏑⏑⏑",@reversestr([@Scansion]),2))*0,1))',
	LemmaArray:
		'="["&quote&TEXTJOIN(quote&","&quote,TRUE,wordsform[@[Lemma1]:[Lemma5]])&quote&"]"',
	IsLemma:
		'=IF(OR([@Word]=LEFT([@Lemma1],IFERROR(FIND("[",[@Lemma1])-1,LEN([@Lemma1]))),[@Word]=LEFT([@Lemma2],IFERROR(FIND("[",[@Lemma2])-1,LEN([@Lemma2]))),[@Word]=LEFT([@Lemma3],IFERROR(FIND("[",[@Lemma3])-1,LEN([@Lemma3]))),[@Word]=LEFT([@Lemma4],IFERROR(FIND("[",[@Lemma4])-1,LEN([@Lemma4]))),[@Word]=LEFT([@Lemma5],IFERROR(FIND("[",[@Lemma5])-1,LEN([@Lemma5])))),1,0)',
	IsNonLemma:
		'=IF(SUM([@Word]=LEFT([@Lemma1],IFERROR(FIND("[",[@Lemma1])-1,LEN([@Lemma1]))),[@Word]=LEFT([@Lemma2],IFERROR(FIND("[",[@Lemma2])-1,LEN([@Lemma2]))),[@Word]=LEFT([@Lemma3],IFERROR(FIND("[",[@Lemma3])-1,LEN([@Lemma3]))),[@Word]=LEFT([@Lemma4],IFERROR(FIND("[",[@Lemma4])-1,LEN([@Lemma4]))),[@Word]=LEFT([@Lemma5],IFERROR(FIND("[",[@Lemma5])-1,LEN([@Lemma5]))))=5-COUNTIF(wordsform[@[Lemma1]:[Lemma5]],""),0,1)',
	DuplicateWords:
		'=IFERROR(IF(DuplicateCheck="OFF",IF(ROW()=2,"",CONCAT("wordsform line ",MATCH(TRUE,EXACT([@Word],INDIRECT("$B$2:$B$"&ROW())),0))),IFERROR(HYPERLINK("[velut.xlsm]words!B"&1+MATCH(TRUE,EXACT(words[Word],[@Word]),0),CONCAT(IF(EXACT(INDEX(words[Lemmata],MATCH(TRUE,EXACT(words[Word],[@Word]),0)),[@Lemmata]),"DELETE ",""),"words ",MATCH(TRUE,EXACT(words[Word],[@Word]),0)," ",INDEX(words[Lemmata],MATCH(TRUE,EXACT(words[Word],[@Word]),0)))),IFERROR(IF(MATCH(TRUE,EXACT([@Word],[Word]),0)=ROW([@Word])-1,"",HYPERLINK("[velut.xlsm]wordsform!B"&1+MATCH(TRUE,EXACT([@Word],[Word]),0),CONCAT(IF(EXACT([@Lemmata],INDEX([Lemmata],MATCH(TRUE,EXACT([@Word],[Word]),0),1)),"DELETE ",""),"wordsform line ",MATCH(TRUE,EXACT([@Word],[Word]),0)," ",INDEX([Lemmata],MATCH(TRUE,EXACT([@Word],[Word]),0),1)))),""))),"")',
	NewLemmata:
		'=IF([@Lemma1]="","",TEXTJOIN(" ",TRUE,IFERROR(LEFT(XMATCH(TRUE,EXACT([@Lemma1],lemmata[Lemma])),0),IF(SUM(--EXACT([@Lemma1],INDIRECT("AJ1:AJ"&ROW()-1)))=0,[@Lemma1],"")),IFERROR(LEFT(XMATCH(TRUE,EXACT([@Lemma2],lemmata[Lemma])),0),IF(SUM(--EXACT([@Lemma2],INDIRECT("AJ1:AJ"&ROW()-1)))=0,[@Lemma2],"")),IFERROR(LEFT(XMATCH(TRUE,EXACT([@Lemma3],lemmata[Lemma])),0),IF(SUM(--EXACT([@Lemma3],INDIRECT("AJ1:AJ"&ROW()-1)))=0,[@Lemma3],"")),IFERROR(LEFT(XMATCH(TRUE,EXACT([@Lemma4],lemmata[Lemma])),0),IF(SUM(--EXACT([@Lemma4],INDIRECT("AJ1:AJ"&ROW()-1)))=0,[@Lemma4],"")),IFERROR(LEFT(XMATCH(TRUE,EXACT([@Lemma5],lemmata[Lemma])),0),IF(SUM(--EXACT([@Lemma5],INDIRECT("AJ1:AJ"&ROW()-1)))=0,[@Lemma5],""))))',
	NoMacra:
		'=@NoMacra([@Word])',
	NoMacraLowerCase:
		'=LOWER([@NoMacra])',
	AlphOrderNoMacra:
		'=@SortString(NoMacra(LOWER([@Word])))',
	Sort:
		'=CONCAT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(CONCAT([@RhymeVowels],"-",SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@NoMacra([@PerfectRhyme]),"a","a"),"e","a"),"i","a"),"o","a"),"u","a"),"y","a"),"à","a"),"â","a"),"è","a"),"€","a"),"ò","a"),"ù","a"),"ã","a"),"ẽ","a"),"ĩ","a"),"õ","a"),"ũ","a"),"ỹ","a"),"-",IFERROR(@reversestr(LEFT([@AllVowels],LEN([@AllVowels])-LEN([@RhymeVowels]))),""),"-",SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(@reversestr(LEFT([@Phonetic],LEN([@Phonetic])-LEN([@PerfectRhyme]))),"a","a"),"e","a"),"i","a"),"o","a"),"u","a"),"y","a"),"à","a"),"â","a"),"è","a"),"€","a"),"ò","a"),"ù","a"),"ã","a"),"ẽ","a"),"ĩ","a"),"õ","a"),"ũ","a"),"ỹ","a")),"ā","azzzz"),"ē","ezzzz"),"ī","izzzz"),"ō","ozzzz"),"ū","uzzzz"),"ȳ","yzzzz"),"ã","azzzzzz"),"ẽ","ezzzzzz"),"ĩ","izzzzzz"),"õ","ozzzzzz"),"ũ","uzzzzzz"),"ỹ","yzzzzzz"),"à","azzzzzzzz"),"â","azzzzzzzzzzzz"),"è","ezzzzzzzz"),"€","ezzzzzzzzzzzz"),"ò","ozzzzzzzz"),"ù","uzzzzzzzz"),"-",LOWER([@Word]),IFERROR(IF(EXACT(LEFT([@Word],1),LOWER(LEFT([@Word],1))),"/",""),""))',
	RepeatWord:
		'=[@Word]',
}
